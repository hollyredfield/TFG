import{j as e}from"./ui-BJ93jQot.js";import{a}from"./vendor-TA_wDYrC.js";import{m as h}from"./mockData-0ElwO_P3.js";import{O as C}from"./OfferCard-COSGjkOA.js";import{k as S,a3 as _,U as F,aa as k,aE as O}from"./index-BlDEwxQf.js";import"./ImageWithFallback-BgI07kEf.js";import"./StarRating-DMe66NK6.js";import"react-toastify";const $=()=>{const[n,f]=a.useState([]),[b,u]=a.useState(!0),[m,j]=a.useState(null),[l,g]=a.useState("grid"),[d,y]=a.useState("popular"),[i,v]=a.useState("all"),[t,x]=a.useState({min:"",max:""}),[c,N]=a.useState(""),[p,w]=a.useState(!1);return a.useEffect(()=>{setTimeout(()=>{try{let r=[...h.ofertas];if(i!=="all"&&(r=r.filter(s=>s.id_categoria===parseInt(i))),t.min&&(r=r.filter(s=>s.precio_actual>=parseFloat(t.min))),t.max&&(r=r.filter(s=>s.precio_actual<=parseFloat(t.max))),c){const s=c.toLowerCase();r=r.filter(o=>o.titulo.toLowerCase().includes(s)||o.descripcion.toLowerCase().includes(s))}r.sort((s,o)=>{switch(d){case"price_asc":return s.precio_actual-o.precio_actual;case"price_desc":return o.precio_actual-s.precio_actual;case"newest":return new Date(o.createdAt)-new Date(s.createdAt);case"discount":return o.porcentaje_descuento-s.porcentaje_descuento;case"popular":default:return o.likes-s.likes}}),f(r),u(!1)}catch(r){console.error("Error loading popular offers:",r),j("No se pudieron cargar las ofertas populares"),u(!1)}},500)},[d,i,t,c]),e.jsx("div",{className:"min-h-screen pt-16 pb-12 bg-gray-100",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-4 bg-white p-4 rounded-lg shadow",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center mb-2",children:[e.jsx(S,{className:"text-orange-500 mr-3"}),"Todas las ofertas"]}),e.jsxs("p",{className:"text-gray-600",children:["+ ",n.length," resultados para tus búsquedas"]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg shadow",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center mb-4",children:[e.jsxs("div",{className:"flex-1 flex",children:[e.jsx("input",{type:"text",placeholder:"Buscar ofertas...",value:c,onChange:r=>N(r.target.value),className:"flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("button",{className:"bg-orange-500 text-white px-4 py-2 rounded-r-lg hover:bg-orange-600",children:e.jsx(_,{})})]}),e.jsxs("button",{onClick:()=>w(!p),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 flex items-center",children:[e.jsx(F,{className:"mr-2"}),"Filtros"]}),e.jsxs("select",{value:d,onChange:r=>y(r.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"popular",children:"Más populares"}),e.jsx("option",{value:"newest",children:"Más recientes"}),e.jsx("option",{value:"price_asc",children:"Precio: menor a mayor"}),e.jsx("option",{value:"price_desc",children:"Precio: mayor a menor"}),e.jsx("option",{value:"discount",children:"Mayor descuento"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-lg ${l==="grid"?"bg-orange-500 text-white":"bg-gray-200 text-gray-700"}`,children:e.jsx(k,{})}),e.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-lg ${l==="list"?"bg-orange-500 text-white":"bg-gray-200 text-gray-700"}`,children:e.jsx(O,{})})]})]}),p&&e.jsx("div",{className:"p-4 border-t border-gray-200 mt-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),e.jsxs("select",{value:i,onChange:r=>v(r.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"all",children:"Todas las categorías"}),h.categorias.map(r=>e.jsx("option",{value:r.id,children:r.nombre},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio mínimo"}),e.jsx("input",{type:"number",value:t.min,onChange:r=>x({...t,min:r.target.value}),placeholder:"€",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio máximo"}),e.jsx("input",{type:"number",value:t.max,onChange:r=>x({...t,max:r.target.value}),placeholder:"€",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]})})]}),b?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"})}):m?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow p-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:m})}):n.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No hay ofertas disponibles"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron ofertas que coincidan con tus criterios de búsqueda."})]}):e.jsx("div",{className:`grid ${l==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"} gap-6`,children:n.map(r=>e.jsx(C,{offer:r,viewMode:l},r.id))})]})})};export{$ as default};
