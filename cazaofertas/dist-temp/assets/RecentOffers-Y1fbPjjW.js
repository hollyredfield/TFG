import{j as e}from"./ui-BJ93jQot.js";import{a}from"./vendor-TA_wDYrC.js";import{m as h}from"./mockData-0ElwO_P3.js";import{O as C}from"./OfferCard-COSGjkOA.js";import{an as S,a3 as _,U as F,aa as k,aE as O}from"./index-BlDEwxQf.js";import"./ImageWithFallback-BgI07kEf.js";import"./StarRating-DMe66NK6.js";import"react-toastify";const q=()=>{const[n,f]=a.useState([]),[b,m]=a.useState(!0),[u,j]=a.useState(null),[d,y]=a.useState("newest"),[g,v]=a.useState(!1),[t,x]=a.useState({min:"",max:""}),[l,N]=a.useState(""),[i,w]=a.useState("all"),[c,p]=a.useState("grid");return a.useEffect(()=>{setTimeout(()=>{try{let s=[...h.ofertas];if(i!=="all"&&(s=s.filter(r=>r.id_categoria===parseInt(i))),t.min&&(s=s.filter(r=>r.precio_actual>=parseFloat(t.min))),t.max&&(s=s.filter(r=>r.precio_actual<=parseFloat(t.max))),l){const r=l.toLowerCase();s=s.filter(o=>o.titulo.toLowerCase().includes(r)||o.descripcion.toLowerCase().includes(r))}s.sort((r,o)=>{switch(d){case"price_asc":return r.precio_actual-o.precio_actual;case"price_desc":return o.precio_actual-r.precio_actual;case"popular":return o.likes-r.likes;case"discount":return o.porcentaje_descuento-r.porcentaje_descuento;case"newest":default:return new Date(o.createdAt)-new Date(r.createdAt)}}),f(s),m(!1)}catch(s){console.error("Error loading offers:",s),j("No se pudieron cargar las ofertas"),m(!1)}},500)},[d,i,t,l]),e.jsx("div",{className:"min-h-screen pt-16 pb-12 bg-gray-100",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-4 bg-white p-4 rounded-lg shadow",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center mb-2",children:[e.jsx(S,{className:"text-orange-500 mr-3"}),"Ofertas Recientes"]}),e.jsxs("p",{className:"text-gray-600",children:["+ ",n.length," resultados para tus búsquedas"]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg shadow",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center mb-4",children:[e.jsxs("div",{className:"flex-1 flex",children:[e.jsx("input",{type:"text",placeholder:"Buscar ofertas...",value:l,onChange:s=>N(s.target.value),className:"flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("button",{className:"bg-orange-500 text-white px-4 py-2 rounded-r-lg hover:bg-orange-600",children:e.jsx(_,{})})]}),e.jsxs("button",{onClick:()=>v(!g),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 flex items-center",children:[e.jsx(F,{className:"mr-2"}),"Filtros"]}),e.jsxs("select",{value:d,onChange:s=>y(s.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"newest",children:"Más recientes"}),e.jsx("option",{value:"popular",children:"Más populares"}),e.jsx("option",{value:"price_asc",children:"Precio: menor a mayor"}),e.jsx("option",{value:"price_desc",children:"Precio: mayor a menor"}),e.jsx("option",{value:"discount",children:"Mayor descuento"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p("grid"),className:`p-2 rounded-lg ${c==="grid"?"bg-orange-500 text-white":"bg-gray-200 text-gray-700"}`,children:e.jsx(k,{})}),e.jsx("button",{onClick:()=>p("list"),className:`p-2 rounded-lg ${c==="list"?"bg-orange-500 text-white":"bg-gray-200 text-gray-700"}`,children:e.jsx(O,{})})]})]}),g&&e.jsx("div",{className:"p-4 border-t border-gray-200 mt-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoría"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500",value:i,onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"all",children:"Todas las categorías"}),h.categorias.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio mínimo"}),e.jsx("input",{type:"number",value:t.min,onChange:s=>x({...t,min:s.target.value}),placeholder:"€",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio máximo"}),e.jsx("input",{type:"number",value:t.max,onChange:s=>x({...t,max:s.target.value}),placeholder:"€",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]})})]}),b?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"})}):u?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow p-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:u})}):n.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No hay ofertas disponibles"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron ofertas que coincidan con los filtros seleccionados."})]}):e.jsx("div",{className:`grid ${c==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"} gap-6`,children:n.map(s=>e.jsx(C,{offer:s,viewMode:c},s.id))})]})})};export{q as default};
