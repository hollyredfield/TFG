import{j as t}from"./ui-BJ93jQot.js";import{f as q,a as o,L as x}from"./vendor-TA_wDYrC.js";import{a as E,g as P,I as p,P as a}from"./ImageWithFallback-BgI07kEf.js";import{ar as L,u as O,aJ as T,Z as b,af as j,_ as y,aI as W,x as v,L as N,g as $,V}from"./index-BlDEwxQf.js";import{S as z}from"./StarRating-DMe66NK6.js";const G=({offer:e,viewMode:k="grid"})=>{const{addToCart:w}=L(),{user:_}=O(),{addToWishlist:F,removeFromWishlist:I,isInWishlist:C}=T(),D=q(),[r,g]=o.useState(!1),n=e!=null&&e.id?C(e.id):!1,i=o.useMemo(()=>{if(!e)return null;const s=e.categoria_id||e.categoria&&e.categoria.id;return s?E(s):null},[e]),m=o.useMemo(()=>{const s=(e==null?void 0:e.categoria_id)||(e==null?void 0:e.categoria)&&e.categoria.id,l=(e==null?void 0:e.tienda)||(e==null?void 0:e.store_name)||"";return P((e==null?void 0:e.url_imagen)||(e==null?void 0:e.imagen_url),e==null?void 0:e.titulo,s,l,e)},[e]),d=s=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(s),u=s=>{s.preventDefault(),s.stopPropagation(),g(!0),w({id:e.id,title:e.titulo,price:e.precio_oferta,originalPrice:e.precio_original,discountPercentage:e.discountPercentage,image:e.imageUrl,store:e.tiendaId,url:e.link_oferta||`/oferta/${e.slug}`,quantity:1}),setTimeout(()=>{g(!1)},1500)},R=()=>{const s=new Date,l=new Date;l.setDate(s.getDate()+2);const A=l.getDate(),S=l.toLocaleString("es-ES",{month:"long"});return`Rec칤belo el martes, ${A} de ${S}`},h=s=>{if(s.preventDefault(),s.stopPropagation(),!_){V.error("Debes iniciar sesi칩n para guardar ofertas."),D("/login");return}n?I(e.id):F(e)},c=`/oferta/${e.slug}`;return console.log(`Creando enlace con slug: ${e.slug} para oferta:`,e.titulo),k==="list"?t.jsxs("div",{className:"group relative flex bg-white dark:bg-gray-800 shadow-soft hover:shadow-xl transition-all duration-300 rounded-lg overflow-hidden my-3 border border-transparent hover:border-indigo-500",children:[t.jsx("button",{onClick:h,className:"absolute top-2 right-2 z-20 p-2 bg-white/80 dark:bg-gray-900/80 rounded-full text-gray-600 dark:text-gray-300 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:n?"Quitar de la lista de deseos":"Guardar en lista de deseos",children:n?t.jsx(b,{className:"text-red-500"}):t.jsx(j,{})}),t.jsxs(x,{to:c,className:"flex w-full",children:[t.jsxs("div",{className:"relative w-1/4 p-3 flex-shrink-0",children:[e.porcentaje_descuento>0&&t.jsxs("div",{className:"absolute left-1 top-1 z-10 bg-red-600 text-white text-xs font-bold rounded px-1.5 py-0.5",children:["-",e.porcentaje_descuento,"%"]}),"            ",t.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gray-100 dark:bg-gray-700 rounded-md",children:["              ",t.jsx(p,{src:m,alt:e.titulo,categoryId:(e==null?void 0:e.categoria_id)||(e==null?void 0:e.categoria)&&e.categoria.id,storeName:(e==null?void 0:e.tienda)||(e==null?void 0:e.store_name)||"",product:e,className:"h-full w-full object-contain p-1"})]})]}),t.jsxs("div",{className:"flex-1 p-3 flex flex-col",children:[t.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mb-1",children:[t.jsx(y,{className:"mr-1.5 text-indigo-500"}),t.jsx("span",{children:e.tienda}),i&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mx-1.5",children:"췅"}),t.jsx("span",{style:{color:i.color},children:i.icon}),t.jsx("span",{className:"ml-1",children:i.name})]})]}),t.jsx("h3",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-white mb-1 line-clamp-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400",children:e.titulo}),t.jsx("p",{className:"text-gray-600 mb-2 line-clamp-2 text-sm",children:e.descripcion}),t.jsxs("div",{className:"flex items-end justify-between mt-auto",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:d(e.precio_oferta)}),e.precio_original&&e.precio_original>e.precio_oferta&&t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 line-through",children:d(e.precio_original)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"px-3 py-1.5 rounded-md text-xs font-medium bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 transition-colors inline-flex items-center cursor-pointer",title:"Ver detalles",children:[t.jsx(W,{className:"mr-1.5"})," Ver Detalles"]}),t.jsx("button",{onClick:u,disabled:r,className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors inline-flex items-center ${r?"bg-green-600 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,children:r?t.jsxs(t.Fragment,{children:[t.jsx(v,{className:"mr-1.5"})," A침adido"]}):t.jsxs(t.Fragment,{children:[t.jsx(N,{className:"mr-1.5"})," A침adir"]})})]})]}),e.likes!==void 0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(z,{rating:e.rating||0,size:"sm"}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:[e.likes," valoraciones"]})]})]})]})]}):t.jsxs("div",{className:"group relative flex flex-col overflow-hidden rounded-xl bg-white dark:bg-gray-800 shadow-soft transition-all duration-300 hover:shadow-xl h-full border border-transparent hover:border-indigo-500",children:[t.jsx("button",{onClick:h,className:"absolute top-3 right-3 z-20 p-2 bg-white/80 dark:bg-gray-900/80 rounded-full text-gray-600 dark:text-gray-300 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:n?"Quitar de la lista de deseos":"Guardar en lista de deseos",children:n?t.jsx(b,{className:"text-red-500"}):t.jsx(j,{})}),t.jsxs(x,{to:c,className:"flex flex-col h-full",children:[t.jsxs("div",{className:"relative p-4 flex items-center justify-center bg-gray-50 dark:bg-gray-700/30",children:[e.porcentaje_descuento>0&&t.jsxs("div",{className:"absolute left-2 top-2 z-10 bg-red-600 text-white text-xs font-bold rounded px-1.5 py-0.5",children:["-",e.porcentaje_descuento,"%"]}),e.tags&&e.tags.includes("REGALO")&&t.jsx("div",{className:"absolute top-2 right-2 bg-purple-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-md",children:"游꾸 REGALO"}),"          ",t.jsxs("div",{className:"w-full aspect-square overflow-hidden flex items-center justify-center h-[160px] sm:h-[180px]",children:["            ",t.jsx(p,{src:m,alt:e.titulo,categoryId:(e==null?void 0:e.categoria_id)||(e==null?void 0:e.categoria)&&e.categoria.id,storeName:(e==null?void 0:e.tienda)||(e==null?void 0:e.store_name)||"",product:e,className:"max-h-full w-auto object-contain transition-transform duration-300 group-hover:scale-105"})]})]}),t.jsxs("div",{className:"flex flex-grow flex-col p-4",children:[t.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mb-1",children:[t.jsx(y,{className:"mr-1.5 text-indigo-500"}),t.jsx("span",{children:e.tienda}),i&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mx-1.5",children:"|"}),t.jsx("span",{style:{color:i.color},className:"font-medium",children:i.name})]})]}),t.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100 line-clamp-2 mb-2 h-[40px] group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors",children:e.titulo}),t.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[t.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:d(e.precio_oferta)}),e.precio_original&&e.precio_original>e.precio_oferta&&t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 line-through",children:d(e.precio_original)})]}),e.likes!==void 0&&t.jsxs("div",{className:"flex items-center mb-3 text-xs",children:[t.jsx($,{className:"mr-1 text-yellow-400"}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:[e.likes," valoraciones"]})]}),t.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 mb-3",children:t.jsx("span",{children:R()})}),t.jsxs("div",{className:"mt-auto space-y-2",children:[t.jsx("button",{onClick:u,disabled:r,className:`w-full flex justify-center items-center py-2 px-4 rounded-md transition-colors text-sm font-medium ${r?"bg-green-600 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,children:r?t.jsxs(t.Fragment,{children:[t.jsx(v,{className:"mr-2"}),"A침adido"]}):t.jsxs(t.Fragment,{children:[t.jsx(N,{className:"mr-2"}),"A침adir al carrito"]})}),t.jsx(x,{to:c,className:"w-full block text-center py-2 px-4 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 transition-colors text-sm font-medium",title:"Ver detalles",children:"Ver Detalles"})]})]})]})]})};G.propTypes={offer:a.shape({id:a.string.isRequired,titulo:a.string.isRequired,descripcion:a.string,precio_actual:a.number.isRequired,precio_original:a.number.isRequired,porcentaje_descuento:a.number,url_imagen:a.string,tienda:a.string,votos_positivos:a.number,comentarios_count:a.number,creado_en:a.string,slug:a.string.isRequired,id_categoria:a.number,tags:a.arrayOf(a.string),isHot:a.bool,rating:a.number,likes:a.number,dislikes:a.number,commentsCount:a.number,createdAt:a.string,updatedAt:a.string}).isRequired,viewMode:a.oneOf(["grid","list"])};export{G as O};
