import{j as e}from"./ui-BJ93jQot.js";import{i as F,a as n,L as g}from"./vendor-TA_wDYrC.js";import{m as l}from"./mockData-0ElwO_P3.js";import{O as T}from"./OfferCard-COSGjkOA.js";import{a8 as P,a9 as $,aa as D,ab as M,ac as V,U as A}from"./index-BlDEwxQf.js";import"./ImageWithFallback-BgI07kEf.js";import"./StarRating-DMe66NK6.js";import"react-toastify";const J=()=>{var y;const{filterType:o,filterValue:r}=F(),[j,w]=n.useState([]),[v,N]=n.useState("Todas las Ofertas"),[c,x]=n.useState("grid"),[k,C]=n.useState(1),f=12,[d,O]=n.useState("relevancia"),[m,u]=n.useState(!1),p=[{key:"relevancia",label:"Relevancia"},{key:"precio_asc",label:"Precio: Más Bajo a Más Alto"},{key:"precio_desc",label:"Precio: Más Alto a Más Bajo"},{key:"descuento",label:"Mayor Descuento"},{key:"popularidad",label:"Popularidad (Mejor Valorados)"},{key:"nuevos",label:"Más Recientes"}];n.useEffect(()=>{let a=[...l.ofertas],i="Todas las Ofertas";if(o&&r)if(o==="categoria"){const s=l.categorias.find(t=>t.slug===r);s?(i=`Ofertas de ${s.nombre}`,a=l.ofertas.filter(t=>t.categoriaId===s.id)):(i=`Categoría no encontrada: ${r}`,a=[])}else if(o==="tienda"){const s=l.tiendas.find(t=>t.slug===r);s?(i=`Ofertas de ${s.nombre}`,a=l.ofertas.filter(t=>t.tiendaId===s.id)):(i=`Tienda no encontrada: ${r}`,a=[])}else o==="busqueda"&&(i=`Resultados para "${r}"`,a=l.ofertas.filter(s=>s.titulo.toLowerCase().includes(r.toLowerCase())||s.descripcion.toLowerCase().includes(r.toLowerCase())||s.tags&&s.tags.some(t=>t.toLowerCase().includes(r.toLowerCase()))));switch(N(i),d){case"precio_asc":a.sort((s,t)=>s.precio_oferta-t.precio_oferta);break;case"precio_desc":a.sort((s,t)=>t.precio_oferta-s.precio_oferta);break;case"descuento":a.sort((s,t)=>{const S=s.precio_original>0?(s.precio_original-s.precio_oferta)/s.precio_original:0;return(t.precio_original>0?(t.precio_original-t.precio_oferta)/t.precio_original:0)-S}),a.sort((s,t)=>(t.rating||0)-(s.rating||0));break;case"nuevos":a.sort((s,t)=>new Date(t.createdAt)-new Date(s.createdAt));break}w(a),C(1)},[o,r,d]);const h=k*f,_=h-f,b=j.slice(_,h),L=a=>{O(a),u(!1)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-700 text-white p-6 rounded-lg shadow-xl mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:v}),e.jsx("p",{className:"text-indigo-200",children:"Explora las mejores ofertas seleccionadas para ti. Usa los filtros y opciones de ordenación para encontrar exactamente lo que buscas."}),o&&r&&e.jsxs(g,{to:"/ofertas",className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(P,{className:"mr-2"})," Ver Todas las Ofertas / Limpiar Filtros"]})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-center gap-4 p-4 bg-gray-800 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-gray-400 text-sm mr-2",children:"Vista:"}),e.jsx("button",{onClick:()=>x("list"),className:`p-2 rounded-md transition-colors ${c==="list"?"bg-indigo-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,title:"Vista de Lista",children:e.jsx($,{})}),e.jsx("button",{onClick:()=>x("grid"),className:`p-2 rounded-md transition-colors ${c==="grid"?"bg-indigo-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,title:"Vista de Cuadrícula",children:e.jsx(D,{})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>u(!m),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-md transition-colors",children:[e.jsx(M,{}),((y=p.find(a=>a.key===d))==null?void 0:y.label)||"Ordenar",e.jsx(V,{className:`ml-1 transition-transform ${m?"rotate-180":""}`})]}),m&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-gray-700 rounded-md shadow-lg z-10 py-1",children:p.map(a=>e.jsx("a",{href:"#",onClick:i=>{i.preventDefault(),L(a.key)},className:`block px-4 py-2 text-sm ${d===a.key?"bg-indigo-500 text-white":"text-gray-200 hover:bg-gray-600"}`,children:a.label},a.key))})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-md transition-colors",title:"Funcionalidad de filtro próximamente",children:[e.jsx(A,{})," Filtrar (Próximamente)"]})]})]}),b.length>0?e.jsx("div",{className:`grid ${c==="grid"?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4":"grid-cols-1"} gap-6`,children:b.map(a=>e.jsx(T,{offer:a,viewMode:c},a.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("img",{src:"/img/empty-box.svg",alt:"No hay ofertas",className:"mx-auto mb-6 h-40 w-40 text-gray-500"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-300 mb-2",children:"No se encontraron ofertas"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:[o&&r?"Intenta ajustar tu búsqueda o filtros, o ":"Parece que no hay ofertas que coincidan con tus criterios. ","Explora nuestras ",e.jsx(g,{to:"/categorias",className:"text-indigo-400 hover:underline",children:"categorías populares"})," o ",e.jsx(g,{to:"/ofertas",className:"text-indigo-400 hover:underline",children:"mira todas las ofertas"}),"."]}),o&&r&&e.jsx(g,{to:"/ofertas",className:"px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Ver Todas las Ofertas"})]})]})};export{J as default};
