import{j as e}from"./ui-BJ93jQot.js";import{a as x,L as M}from"./vendor-TA_wDYrC.js";import{u as A,D as $,o as B,l as H,x as u,U as W,W as f,X as a,i as o,Y as h,Q as j,Z as b,_ as y,P as v,$ as i,a0 as c,h as Y,a1 as D,a2 as V,V as w}from"./index-BlDEwxQf.js";import"react-toastify";const X=()=>{const{user:_}=A(),{notifications:p,isLoading:F,error:S,markAsRead:k,markAllAsRead:O,deleteNotification:T,updatePreferences:C}=$(),[t,N]=x.useState([]),[n,E]=x.useState(!1),[d,m]=x.useState(!1),[r,R]=x.useState({email:!0,push:!0,offers:!0,system:!0,promotions:!0}),I=s=>{t.includes(s)?N(t.filter(L=>L!==s)):N([...t,s])},l=s=>{R({...r,[s]:!r[s]})},P=()=>{C(r).then(()=>{w.success("Preferencias guardadas correctamente"),m(!1)}).catch(()=>{w.error("Error al guardar preferencias")})},g=t.length>0?p.filter(s=>t.includes(s.tipo)):p;return F?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})}):S?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"text-red-500 mr-3"}),e.jsx("p",{className:"text-red-700",children:"Error al cargar notificaciones. Inténtalo de nuevo más tarde."})]})})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[e.jsx(H,{className:"mr-2 text-primary"}),"Notificaciones"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>O(),className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg text-sm flex items-center",children:[e.jsx(u,{className:"mr-1"})," Marcar todas como leídas"]}),e.jsxs("button",{onClick:()=>E(!n),className:`${n?"bg-primary text-white":"bg-gray-100 text-gray-700"} hover:bg-primary hover:text-white py-2 px-4 rounded-lg text-sm flex items-center`,children:[e.jsx(W,{className:"mr-1"})," Filtrar"]}),e.jsxs("button",{onClick:()=>m(!d),className:`${d?"bg-primary text-white":"bg-gray-100 text-gray-700"} hover:bg-primary hover:text-white py-2 px-4 rounded-lg text-sm flex items-center`,children:[e.jsx(f,{className:"mr-1"})," Preferencias"]})]})]}),n&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 mb-6 border border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Filtrar por tipo"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.values(a).map(s=>e.jsxs("button",{onClick:()=>I(s),className:`py-1.5 px-3 rounded-full text-sm flex items-center ${t.includes(s)?"bg-primary text-white":"bg-gray-100 text-gray-700"}`,children:[s===a.OFFER&&e.jsx(o,{className:"mr-1"}),s===a.SYSTEM&&e.jsx(h,{className:"mr-1"}),s===a.PROMOTION&&e.jsx(j,{className:"mr-1"}),s===a.WISHLIST&&e.jsx(b,{className:"mr-1"}),s===a.STORE&&e.jsx(y,{className:"mr-1"}),s===a.ORDER&&e.jsx(v,{className:"mr-1"}),s]},s))})]}),d&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 mb-6 border border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Preferencias de notificaciones"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:"Notificaciones por email"})]}),e.jsx("button",{onClick:()=>l("email"),children:r.email?e.jsx(i,{className:"text-primary text-2xl"}):e.jsx(c,{className:"text-gray-400 text-2xl"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:"Notificaciones push"})]}),e.jsx("button",{onClick:()=>l("push"),children:r.push?e.jsx(i,{className:"text-primary text-2xl"}):e.jsx(c,{className:"text-gray-400 text-2xl"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:"Notificaciones de ofertas"})]}),e.jsx("button",{onClick:()=>l("offers"),children:r.offers?e.jsx(i,{className:"text-primary text-2xl"}):e.jsx(c,{className:"text-gray-400 text-2xl"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:"Notificaciones del sistema"})]}),e.jsx("button",{onClick:()=>l("system"),children:r.system?e.jsx(i,{className:"text-primary text-2xl"}):e.jsx(c,{className:"text-gray-400 text-2xl"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:"Promociones y descuentos"})]}),e.jsx("button",{onClick:()=>l("promotions"),children:r.promotions?e.jsx(i,{className:"text-primary text-2xl"}):e.jsx(c,{className:"text-gray-400 text-2xl"})})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{onClick:()=>m(!1),className:"text-gray-600 bg-gray-100 hover:bg-gray-200 py-2 px-4 rounded-lg mr-2",children:"Cancelar"}),e.jsx("button",{onClick:P,className:"bg-primary hover:bg-primary-dark text-white py-2 px-4 rounded-lg",children:"Guardar preferencias"})]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg divide-y divide-gray-200",children:g.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(D,{className:"text-gray-400 text-5xl mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-600",children:"No tienes notificaciones"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Las notificaciones aparecerán aquí"})]}):g.map(s=>e.jsx("div",{className:`p-4 transition-all duration-200 hover:bg-gray-50 ${s.leido?"opacity-70":"opacity-100 bg-blue-50/30"}`,children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:`mt-1 mr-4 rounded-full p-2 ${s.tipo===a.SYSTEM?"bg-blue-100 text-blue-600":s.tipo===a.OFFER?"bg-green-100 text-green-600":s.tipo===a.PROMOTION?"bg-purple-100 text-purple-600":s.tipo===a.WISHLIST?"bg-red-100 text-red-600":s.tipo===a.STORE?"bg-indigo-100 text-indigo-600":"bg-gray-100 text-gray-600"}`,children:[s.tipo===a.SYSTEM&&e.jsx(h,{className:"h-5 w-5"}),s.tipo===a.OFFER&&e.jsx(o,{className:"h-5 w-5"}),s.tipo===a.PROMOTION&&e.jsx(j,{className:"h-5 w-5"}),s.tipo===a.WISHLIST&&e.jsx(b,{className:"h-5 w-5"}),s.tipo===a.STORE&&e.jsx(y,{className:"h-5 w-5"}),s.tipo===a.ORDER&&e.jsx(v,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:s.titulo}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.mensaje})]}),e.jsxs("div",{className:"flex space-x-2",children:[!s.leido&&e.jsx("button",{onClick:()=>k(s.id),className:"text-primary hover:text-primary-dark",title:"Marcar como leído",children:e.jsx(u,{})}),e.jsx("button",{onClick:()=>T(s.id),className:"text-red-500 hover:text-red-700",title:"Eliminar notificación",children:e.jsx(V,{})})]})]}),e.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.fecha).toLocaleString()}),s.enlace&&e.jsx("div",{children:e.jsxs(M,{to:s.enlace,className:"text-primary hover:text-primary-dark font-medium text-sm inline-flex items-center",children:[s.texto_enlace||"Ver detalles",e.jsx("svg",{className:"ml-1 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]})]})]})},s.id))})]})};export{X as default};
