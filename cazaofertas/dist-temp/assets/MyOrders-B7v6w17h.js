import{j as e}from"./ui-BJ93jQot.js";import{a as l,L as d}from"./vendor-TA_wDYrC.js";import{u as F,o as h,a3 as E,P as b,ad as S,aG as $,aL as f,V as L,Y as j,M as P,x as A}from"./index-BlDEwxQf.js";import{g as O}from"./mockOrders-D2kgro_0.js";import"react-toastify";const q=()=>{const{user:i}=F(),[k,N]=l.useState([]),[w,c]=l.useState(!0),[m,g]=l.useState(null),[r,o]=l.useState("all"),[n,v]=l.useState("");l.useEffect(()=>{async function t(){if(!i){c(!1);return}try{c(!0),g(null);const{data:a,error:s,success:x}=await O(i.id);if(!x||s)throw new Error((s==null?void 0:s.message)||"No se pudieron cargar tus pedidos");N(a||[])}catch(a){console.error("Error cargando pedidos:",a),g("No se pudieron cargar tus pedidos. Por favor, inténtalo de nuevo."),L.error("Error al cargar los pedidos")}finally{c(!1)}}t()},[i]);const p=()=>{let t=k;if(n.trim()){const a=n.toLowerCase().trim();t=t.filter(s=>s.codigo_seguimiento.toLowerCase().includes(a)||s.id.toString().includes(a))}return r!=="all"&&(t=t.filter(a=>a.estado===r)),t},C=t=>{switch(t){case"pendiente":return{icon:e.jsx(j,{}),color:"text-blue-500",bgColor:"bg-blue-100 dark:bg-blue-900/40",textColor:"text-blue-800 dark:text-blue-400"};case"procesando":return{icon:e.jsx(b,{}),color:"text-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/40",textColor:"text-yellow-800 dark:text-yellow-400"};case"enviado":return{icon:e.jsx(f,{}),color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900/40",textColor:"text-purple-800 dark:text-purple-400"};case"entregado":return{icon:e.jsx(A,{}),color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/40",textColor:"text-green-800 dark:text-green-400"};case"cancelado":return{icon:e.jsx(P,{}),color:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/40",textColor:"text-red-800 dark:text-red-400"};default:return{icon:e.jsx(j,{}),color:"text-gray-500",bgColor:"bg-gray-100 dark:bg-gray-700",textColor:"text-gray-800 dark:text-gray-400"}}};return i?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Mis Pedidos"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Revisa y gestiona todos tus pedidos"})]}),e.jsx("div",{className:"mt-4 lg:mt-0 flex",children:e.jsx(d,{to:"/tienda",className:"button-modern button-secondary inline-flex items-center",children:"Seguir comprando"})})]}),m&&e.jsxs("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg mb-6 flex items-start",children:[e.jsx(h,{className:"mt-1 mr-2 flex-shrink-0"}),e.jsx("p",{children:m})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-soft p-4 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"w-full md:w-auto flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-3 py-2 rounded-lg text-sm font-medium ${r==="all"?"bg-primary/10 dark:bg-primary/20 text-primary dark:text-primary-light":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Todos"}),e.jsx("button",{onClick:()=>o("pendiente"),className:`px-3 py-2 rounded-lg text-sm font-medium ${r==="pendiente"?"bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Pendientes"}),e.jsx("button",{onClick:()=>o("procesando"),className:`px-3 py-2 rounded-lg text-sm font-medium ${r==="procesando"?"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-700 dark:text-yellow-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Procesando"}),e.jsx("button",{onClick:()=>o("enviado"),className:`px-3 py-2 rounded-lg text-sm font-medium ${r==="enviado"?"bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Enviados"}),e.jsx("button",{onClick:()=>o("entregado"),className:`px-3 py-2 rounded-lg text-sm font-medium ${r==="entregado"?"bg-green-100 dark:bg-green-900/40 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:"Entregados"})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Buscar por código...",value:n,onChange:t=>v(t.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg pl-10 pr-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]})}),w?e.jsx("div",{className:"flex justify-center items-center py-16",children:e.jsx("div",{className:"animate-spin h-10 w-10 border-3 border-primary rounded-full border-t-transparent"})}):p().length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-soft p-10 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full mb-4",children:e.jsx(b,{className:"text-3xl text-gray-400 dark:text-gray-500"})}),e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:["No hay pedidos ",r!=="all"?`${r}s`:""]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:n?"No se encontraron pedidos que coincidan con tu búsqueda.":r!=="all"?`No tienes pedidos con estado "${r}".`:"Aún no has realizado ningún pedido."}),e.jsx(d,{to:"/tienda",className:"button-modern button-primary",children:"Explorar productos"})]}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-soft overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Pedido"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Productos"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:p().map(t=>{var u,y;const{icon:a,bgColor:s,textColor:x}=C(t.estado);return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["#",t.codigo_seguimiento]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",t.id]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-300",children:[e.jsx(S,{className:"mr-1"}),new Date(t.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s} ${x}`,children:[a,e.jsx("span",{className:"ml-1",children:t.estado.charAt(0).toUpperCase()+t.estado.slice(1)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.total.toFixed(2),"€"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-300",children:[(u=t.pedidos_items)==null?void 0:u.length," producto",((y=t.pedidos_items)==null?void 0:y.length)!==1?"s":""]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsxs(d,{to:`/pedido/${t.id}`,className:"text-primary hover:text-primary-dark dark:hover:text-primary-light",children:[e.jsx($,{}),e.jsx("span",{className:"sr-only",children:"Ver pedido"})]})})})]},t.id)})})]})})}),e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-purple-500/10 dark:from-primary/20 dark:to-purple-500/20 rounded-xl p-6 relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"¿Necesitas ayuda con tu pedido?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Si tienes alguna pregunta o problema con tu pedido, nuestro equipo de soporte está listo para ayudarte."})]}),e.jsxs("div",{className:"space-y-2 md:space-y-0 md:space-x-2 flex flex-col md:flex-row",children:[e.jsx(d,{to:"/soporte",className:"button-modern button-primary",children:"Contactar soporte"}),e.jsx(d,{to:"/preguntas-frecuentes",className:"button-modern button-secondary",children:"Preguntas frecuentes"})]})]}),e.jsx("div",{className:"absolute -bottom-6 -right-6 opacity-10",children:e.jsx(f,{className:"text-9xl text-primary"})})]})})]}):e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{className:"mr-2"}),e.jsx("p",{children:"Debes iniciar sesión para acceder a tus pedidos"})]})}),e.jsxs("div",{className:"flex space-x-4 mt-6",children:[e.jsx(d,{to:"/login",className:"button-modern button-primary",children:"Iniciar sesión"}),e.jsx(d,{to:"/",className:"button-modern button-secondary",children:"Volver al inicio"})]})]})};export{q as default};
