import{j as s}from"./ui-BJ93jQot.js";import{i as ie,a as D,f as ce}from"./vendor-TA_wDYrC.js";import{u as oe,aX as ue,aY as de,an as le,R as me,aZ as fe,as as he,V as h,a2 as I,aD as ge,o as xe}from"./index-BlDEwxQf.js";import{f as Y}from"./forumService-DXNLY8bn.js";import{L as we}from"./Loading-DhytMDVs.js";import{V as X}from"./VoteSystem-C-S41ZoI.js";import{R as be}from"./quill.snow-C9f5Rqf5.js";import{g as H,t as N,c as P,n as ye,a as $,m as ke,b as K,d as ve,f as Ne,e as A}from"./es-tLztjAZs.js";import"react-toastify";import"./mockData-0ElwO_P3.js";function _(r,e){var d,l,y,w;const t=H(),a=(e==null?void 0:e.weekStartsOn)??((l=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((w=(y=t.locale)==null?void 0:y.options)==null?void 0:w.weekStartsOn)??0,n=N(r,e==null?void 0:e.in),i=n.getDay(),u=(i<a?7:0)+i-a;return n.setDate(n.getDate()-u),n.setHours(0,0,0,0),n}function F(r,e){return _(r,{...e,weekStartsOn:1})}function ee(r,e){const t=N(r,e==null?void 0:e.in),a=t.getFullYear(),n=P(t,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const i=F(n),u=P(t,0);u.setFullYear(a,0,4),u.setHours(0,0,0,0);const d=F(u);return t.getTime()>=i.getTime()?a+1:t.getTime()>=d.getTime()?a:a-1}function V(r,e){const t=N(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function Oe(r,e,t){const[a,n]=ye(t==null?void 0:t.in,r,e),i=V(a),u=V(n),d=+i-$(i),l=+u-$(u);return Math.round((d-l)/ke)}function je(r,e){const t=ee(r,e),a=P(r,0);return a.setFullYear(t,0,4),a.setHours(0,0,0,0),F(a)}function Ee(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function De(r){return!(!Ee(r)&&typeof r!="number"||isNaN(+N(r)))}function Te(r,e){const t=N(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Me(r,e){const t=N(r,e==null?void 0:e.in);return Oe(t,Te(t))+1}function Ye(r,e){const t=N(r,e==null?void 0:e.in),a=+F(t)-+je(t);return Math.round(a/K)+1}function te(r,e){var w,O,j,g;const t=N(r,e==null?void 0:e.in),a=t.getFullYear(),n=H(),i=(e==null?void 0:e.firstWeekContainsDate)??((O=(w=e==null?void 0:e.locale)==null?void 0:w.options)==null?void 0:O.firstWeekContainsDate)??n.firstWeekContainsDate??((g=(j=n.locale)==null?void 0:j.options)==null?void 0:g.firstWeekContainsDate)??1,u=P((e==null?void 0:e.in)||r,0);u.setFullYear(a+1,0,i),u.setHours(0,0,0,0);const d=_(u,e),l=P((e==null?void 0:e.in)||r,0);l.setFullYear(a,0,i),l.setHours(0,0,0,0);const y=_(l,e);return+t>=+d?a+1:+t>=+y?a:a-1}function Se(r,e){var d,l,y,w;const t=H(),a=(e==null?void 0:e.firstWeekContainsDate)??((l=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((w=(y=t.locale)==null?void 0:y.options)==null?void 0:w.firstWeekContainsDate)??1,n=te(r,e),i=P((e==null?void 0:e.in)||r,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),_(i,e)}function Pe(r,e){const t=N(r,e==null?void 0:e.in),a=+_(t,e)-+Se(t,e);return Math.round(a/K)+1}function o(r,e){const t=r<0?"-":"",a=Math.abs(r).toString().padStart(e,"0");return t+a}const E={y(r,e){const t=r.getFullYear(),a=t>0?t:1-t;return o(e==="yy"?a%100:a,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):o(t+1,2)},d(r,e){return o(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return o(r.getHours()%12||12,e.length)},H(r,e){return o(r.getHours(),e.length)},m(r,e){return o(r.getMinutes(),e.length)},s(r,e){return o(r.getSeconds(),e.length)},S(r,e){const t=e.length,a=r.getMilliseconds(),n=Math.trunc(a*Math.pow(10,t-3));return o(n,e.length)}},S={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},U={G:function(r,e,t){const a=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(a,{width:"abbreviated"});case"GGGGG":return t.era(a,{width:"narrow"});case"GGGG":default:return t.era(a,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const a=r.getFullYear(),n=a>0?a:1-a;return t.ordinalNumber(n,{unit:"year"})}return E.y(r,e)},Y:function(r,e,t,a){const n=te(r,a),i=n>0?n:1-n;if(e==="YY"){const u=i%100;return o(u,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):o(i,e.length)},R:function(r,e){const t=ee(r);return o(t,e.length)},u:function(r,e){const t=r.getFullYear();return o(t,e.length)},Q:function(r,e,t){const a=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(a);case"QQ":return o(a,2);case"Qo":return t.ordinalNumber(a,{unit:"quarter"});case"QQQ":return t.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(a,{width:"wide",context:"formatting"})}},q:function(r,e,t){const a=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(a);case"qq":return o(a,2);case"qo":return t.ordinalNumber(a,{unit:"quarter"});case"qqq":return t.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(a,{width:"wide",context:"standalone"})}},M:function(r,e,t){const a=r.getMonth();switch(e){case"M":case"MM":return E.M(r,e);case"Mo":return t.ordinalNumber(a+1,{unit:"month"});case"MMM":return t.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(a,{width:"wide",context:"formatting"})}},L:function(r,e,t){const a=r.getMonth();switch(e){case"L":return String(a+1);case"LL":return o(a+1,2);case"Lo":return t.ordinalNumber(a+1,{unit:"month"});case"LLL":return t.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(a,{width:"wide",context:"standalone"})}},w:function(r,e,t,a){const n=Pe(r,a);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):o(n,e.length)},I:function(r,e,t){const a=Ye(r);return e==="Io"?t.ordinalNumber(a,{unit:"week"}):o(a,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):E.d(r,e)},D:function(r,e,t){const a=Me(r);return e==="Do"?t.ordinalNumber(a,{unit:"dayOfYear"}):o(a,e.length)},E:function(r,e,t){const a=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(a,{width:"short",context:"formatting"});case"EEEE":default:return t.day(a,{width:"wide",context:"formatting"})}},e:function(r,e,t,a){const n=r.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return o(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(r,e,t,a){const n=r.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return o(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(r,e,t){const a=r.getDay(),n=a===0?7:a;switch(e){case"i":return String(n);case"ii":return o(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(a,{width:"short",context:"formatting"});case"iiii":default:return t.day(a,{width:"wide",context:"formatting"})}},a:function(r,e,t){const n=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(r,e,t){const a=r.getHours();let n;switch(a===12?n=S.noon:a===0?n=S.midnight:n=a/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(r,e,t){const a=r.getHours();let n;switch(a>=17?n=S.evening:a>=12?n=S.afternoon:a>=4?n=S.morning:n=S.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let a=r.getHours()%12;return a===0&&(a=12),t.ordinalNumber(a,{unit:"hour"})}return E.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):E.H(r,e)},K:function(r,e,t){const a=r.getHours()%12;return e==="Ko"?t.ordinalNumber(a,{unit:"hour"}):o(a,e.length)},k:function(r,e,t){let a=r.getHours();return a===0&&(a=24),e==="ko"?t.ordinalNumber(a,{unit:"hour"}):o(a,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):E.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):E.s(r,e)},S:function(r,e){return E.S(r,e)},X:function(r,e,t){const a=r.getTimezoneOffset();if(a===0)return"Z";switch(e){case"X":return z(a);case"XXXX":case"XX":return T(a);case"XXXXX":case"XXX":default:return T(a,":")}},x:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"x":return z(a);case"xxxx":case"xx":return T(a);case"xxxxx":case"xxx":default:return T(a,":")}},O:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Z(a,":");case"OOOO":default:return"GMT"+T(a,":")}},z:function(r,e,t){const a=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Z(a,":");case"zzzz":default:return"GMT"+T(a,":")}},t:function(r,e,t){const a=Math.trunc(+r/1e3);return o(a,e.length)},T:function(r,e,t){return o(+r,e.length)}};function Z(r,e=""){const t=r>0?"-":"+",a=Math.abs(r),n=Math.trunc(a/60),i=a%60;return i===0?t+String(n):t+String(n)+e+o(i,2)}function z(r,e){return r%60===0?(r>0?"-":"+")+o(Math.abs(r)/60,2):T(r,e)}function T(r,e=""){const t=r>0?"-":"+",a=Math.abs(r),n=o(Math.trunc(a/60),2),i=o(a%60,2);return t+n+e+i}const J=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},re=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},pe=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],a=t[1],n=t[2];if(!n)return J(r,e);let i;switch(a){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",J(a,e)).replace("{{time}}",re(n,e))},We={p:re,P:pe},_e=/^D+$/,Ce=/^Y+$/,qe=["D","DD","YY","YYYY"];function Fe(r){return _e.test(r)}function He(r){return Ce.test(r)}function Be(r,e,t){const a=Re(r,e,t);if(console.warn(a),qe.includes(r))throw new RangeError(a)}function Re(r,e,t){const a=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${a} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Le=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Qe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ge=/^'([^]*?)'?$/,Ie=/''/g,Xe=/[a-zA-Z]/;function $e(r,e,t){var w,O,j,g,b,k,C,q;const a=H(),n=(t==null?void 0:t.locale)??a.locale??ve,i=(t==null?void 0:t.firstWeekContainsDate)??((O=(w=t==null?void 0:t.locale)==null?void 0:w.options)==null?void 0:O.firstWeekContainsDate)??a.firstWeekContainsDate??((g=(j=a.locale)==null?void 0:j.options)==null?void 0:g.firstWeekContainsDate)??1,u=(t==null?void 0:t.weekStartsOn)??((k=(b=t==null?void 0:t.locale)==null?void 0:b.options)==null?void 0:k.weekStartsOn)??a.weekStartsOn??((q=(C=a.locale)==null?void 0:C.options)==null?void 0:q.weekStartsOn)??0,d=N(r,t==null?void 0:t.in);if(!De(d))throw new RangeError("Invalid time value");let l=e.match(Qe).map(m=>{const f=m[0];if(f==="p"||f==="P"){const p=We[f];return p(m,n.formatLong)}return m}).join("").match(Le).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const f=m[0];if(f==="'")return{isToken:!1,value:Ae(m)};if(U[f])return{isToken:!0,value:m};if(f.match(Xe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:m}});n.localize.preprocessor&&(l=n.localize.preprocessor(d,l));const y={firstWeekContainsDate:i,weekStartsOn:u,locale:n};return l.map(m=>{if(!m.isToken)return m.value;const f=m.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&He(f)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&Fe(f))&&Be(f,e,String(r));const p=U[f[0]];return p(d,f,n.localize,y)}).join("")}function Ae(r){const e=r.match(Ge);return e?e[1].replace(Ie,"'"):r}const nt=()=>{var R,L,Q,G;const{threadId:r}=ie(),[e,t]=D.useState(null),[a,n]=D.useState([]),[i,u]=D.useState(""),[d,l]=D.useState(!0),[y,w]=D.useState(!1),[O,j]=D.useState(!1),g=ce(),{user:b,isAuthenticated:k}=oe(),{addBookmark:C,removeBookmark:q,isBookmarked:m}=ue();D.useEffect(()=>{(async()=>{try{const{data:x,error:v}=await Y.getThread(r);if(v){console.error("Error fetching thread:",v),g("/foro");return}if(!x){g("/foro");return}t(x);const{data:M,error:W}=await Y.getThreadMessages(r);W?console.error("Error fetching messages:",W):n(M||[]),k&&b&&j(m(r))}catch(x){console.error("Error in thread detail fetch:",x)}finally{l(!1)}})()},[r,g,k,b,m]);const f=async c=>{if(c.preventDefault(),!k){g("/login",{state:{from:`/foro/tema/${r}`}});return}if(!i.trim()){h.error("No puedes enviar una respuesta vacía");return}w(!0);try{const x={tema_id:r,user_id:b.id,contenido:i},{error:v}=await Y.createMessage(x);if(v){h.error("Error al publicar tu respuesta"),console.error("Error posting reply:",v);return}const{data:M}=await Y.getThreadMessages(r);n(M||[]),u(""),h.success("Tu respuesta ha sido publicada")}catch(x){h.error("Error al publicar tu respuesta"),console.error("Error in submit reply:",x)}finally{w(!1)}},p=async c=>{if(k&&window.confirm("¿Estás seguro de que quieres eliminar este mensaje?"))try{const{error:x}=await Y.deleteMessage(c,b.id);if(x){h.error("Error al eliminar el mensaje"),console.error("Error deleting message:",x);return}n(a.filter(v=>v.id!==c)),h.success("Mensaje eliminado correctamente")}catch(x){h.error("Error al eliminar el mensaje"),console.error("Error in delete message:",x)}},ae=async()=>{if(!(!k||!e||e.user_id!==b.id)&&window.confirm("¿Estás seguro de que quieres eliminar este tema? Se eliminarán todos los mensajes asociados."))try{const{error:c}=await Y.deleteThread(r,b.id);if(c){h.error("Error al eliminar el tema"),console.error("Error deleting thread:",c);return}h.success("Tema eliminado correctamente"),g("/foro")}catch(c){h.error("Error al eliminar el tema"),console.error("Error in delete thread:",c)}},ne=async()=>{if(!k){g("/login",{state:{from:`/foro/tema/${r}`}});return}try{O?q(r)?(j(!1),h.success("Tema eliminado de tus favoritos")):h.error("Error al quitar de favoritos"):C(r,e.titulo)?(j(!0),h.success("Tema añadido a tus favoritos")):h.error("Error al añadir a favoritos")}catch(c){h.error("Error al gestionar favoritos"),console.error("Error toggling bookmark:",c)}},B=c=>$e(new Date(c),"dd MMM yyyy, HH:mm",{locale:A}),se=c=>Ne(new Date(c),{addSuffix:!0,locale:A});return d?s.jsx(we,{}):e?s.jsxs("div",{className:"container-custom py-8",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>g("/foro"),className:"flex items-center text-primary hover:underline",children:[s.jsx(de,{className:"mr-1"})," Volver al foro"]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:e.titulo}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600",children:[s.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:(R=e.foro_categorias)==null?void 0:R.nombre}),s.jsxs("span",{className:"flex items-center",children:[s.jsx(le,{className:"mr-1"})," Creado ",se(e.created_at)]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:ne,className:"text-gray-500 hover:text-primary",title:O?"Quitar de favoritos":"Añadir a favoritos",children:O?s.jsx(me,{size:18,className:"text-primary"}):s.jsx(fe,{size:18})}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),h.success("Enlace copiado al portapapeles")},className:"text-gray-500 hover:text-primary",title:"Compartir enlace",children:s.jsx(he,{size:18})}),k&&b&&e.user_id===b.id&&s.jsx("button",{onClick:ae,className:"text-red-500 hover:text-red-700",title:"Eliminar tema",children:s.jsx(I,{size:18})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:s.jsx("div",{className:"p-6 border-b",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"mr-4",children:s.jsx("img",{src:((L=e.profiles)==null?void 0:L.avatar_url)||"https://via.placeholder.com/60",alt:((Q=e.profiles)==null?void 0:Q.nombre_usuario)||"Avatar",className:"w-12 h-12 rounded-full object-cover"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:((G=e.profiles)==null?void 0:G.nombre_usuario)||"Usuario desconocido"}),s.jsx("span",{className:"text-sm text-gray-500",children:B(e.created_at)}),"          "]}),s.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.contenido}}),s.jsx("div",{className:"mt-4",children:s.jsx(X,{itemId:e.id,itemType:"thread",initialVotes:e.votos_total||0})})]})]})})}),a.length>0?s.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[s.jsx("div",{className:"px-6 py-4 border-b",children:s.jsxs("h3",{className:"text-lg font-semibold",children:[a.length," ",a.length===1?"Respuesta":"Respuestas"]})}),a.map((c,x)=>{var v,M,W;return s.jsx("div",{id:`message-${c.id}`,className:`p-6 ${x!==a.length-1?"border-b":""}`,children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"mr-4",children:s.jsx("img",{src:((v=c.profiles)==null?void 0:v.avatar_url)||"https://via.placeholder.com/50",alt:((M=c.profiles)==null?void 0:M.nombre_usuario)||"Avatar",className:"w-10 h-10 rounded-full object-cover"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("h4",{className:"font-semibold text-gray-800",children:((W=c.profiles)==null?void 0:W.nombre_usuario)||"Usuario desconocido"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("span",{className:"text-sm text-gray-500",children:B(c.created_at)}),k&&b&&c.user_id===b.id&&s.jsx("button",{onClick:()=>p(c.id),className:"text-red-500 hover:text-red-700",title:"Eliminar mensaje",children:s.jsx(I,{size:16})})]})]}),"                  ",s.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:c.contenido}}),s.jsx("div",{className:"mt-3",children:s.jsx(X,{itemId:c.id,itemType:"message",initialVotes:c.votos_total||0})})]})]})},c.id)})]}):s.jsx("div",{className:"bg-white rounded-lg shadow mb-6 p-8 text-center",children:s.jsx("p",{className:"text-gray-500",children:"No hay respuestas todavía. ¡Sé el primero en responder!"})}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Responder"}),k?s.jsxs("form",{onSubmit:f,children:[s.jsx("div",{className:"mb-4",children:s.jsx(be,{theme:"snow",value:i,onChange:u,placeholder:"Escribe tu respuesta aquí..."})}),s.jsxs("button",{type:"submit",disabled:y,className:"bg-primary text-white px-4 py-2 rounded-md flex items-center disabled:opacity-70",children:[s.jsx(ge,{className:"mr-2"})," ",y?"Enviando...":"Responder"]})]}):s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4 text-center",children:[s.jsx(xe,{className:"text-primary mx-auto mb-2",size:24}),s.jsx("p",{className:"mb-4",children:"Necesitas iniciar sesión para responder"}),s.jsx("button",{onClick:()=>g("/login",{state:{from:`/foro/tema/${r}`}}),className:"bg-primary text-white px-4 py-2 rounded-md",children:"Iniciar sesión"})]})]})]}):(g("/foro"),null)};export{nt as default};
